{
  "packageName": "any-promise",
  "packageVersion": "1.3.0",
  "request": "any-promise",
  "resolved": "index.js",
  "files": {
    "index.js": "module.exports = require('./register')().Promise\n",
    "register.js": "\"use strict\"\nmodule.exports = require('./loader')(global, loadImplementation);\n\n/**\n * Node.js version of loadImplementation.\n *\n * Requires the given implementation and returns the registration\n * containing {Promise, implementation}\n *\n * If implementation is undefined or global.Promise, loads it\n * Otherwise uses require\n */\nfunction loadImplementation(implementation){\n  var impl = null\n\n  if(shouldPreferGlobalPromise(implementation)){\n    // if no implementation or env specified use global.Promise\n    impl = {\n      Promise: global.Promise,\n      implementation: 'global.Promise'\n    }\n  } else if(implementation){\n    // if implementation specified, require it\n    var lib = require(implementation)\n    impl = {\n      Promise: lib.Promise || lib,\n      implementation: implementation\n    }\n  } else {\n    // try to auto detect implementation. This is non-deterministic\n    // and should prefer other branches, but this is our last chance\n    // to load something without throwing error\n    impl = tryAutoDetect()\n  }\n\n  if(impl === null){\n    throw new Error('Cannot find any-promise implementation nor'+\n      ' global.Promise. You must install polyfill or call'+\n      ' require(\"any-promise/register\") with your preferred'+\n      ' implementation, e.g. require(\"any-promise/register/bluebird\")'+\n      ' on application load prior to any require(\"any-promise\").')\n  }\n\n  return impl\n}\n\n/**\n * Determines if the global.Promise should be preferred if an implementation\n * has not been registered.\n */\nfunction shouldPreferGlobalPromise(implementation){\n  if(implementation){\n    return implementation === 'global.Promise'\n  } else if(typeof global.Promise !== 'undefined'){\n    // Load global promise if implementation not specified\n    // Versions < 0.11 did not have global Promise\n    // Do not use for version < 0.12 as version 0.11 contained buggy versions\n    var version = (/v(\\d+)\\.(\\d+)\\.(\\d+)/).exec(process.version)\n    return !(version && +version[1] == 0 && +version[2] < 12)\n  }\n\n  // do not have global.Promise or another implementation was specified\n  return false\n}\n\n/**\n * Look for common libs as last resort there is no guarantee that\n * this will return a desired implementation or even be deterministic.\n * The priority is also nearly arbitrary. We are only doing this\n * for older versions of Node.js <0.12 that do not have a reasonable\n * global.Promise implementation and we the user has not registered\n * the preference. This preserves the behavior of any-promise <= 0.1\n * and may be deprecated or removed in the future\n */\nfunction tryAutoDetect(){\n  var libs = [\n      \"es6-promise\",\n      \"promise\",\n      \"native-promise-only\",\n      \"bluebird\",\n      \"rsvp\",\n      \"when\",\n      \"q\",\n      \"pinkie\",\n      \"lie\",\n      \"vow\"]\n  var i = 0, len = libs.length\n  for(; i < len; i++){\n    try {\n      return loadImplementation(libs[i])\n    } catch(e){}\n  }\n  return null\n}\n",
    "package.json": "{\n  \"name\": \"any-promise\",\n  \"version\": \"1.3.0\",\n  \"description\": \"Resolve any installed ES6 compatible promise\",\n  \"main\": \"index.js\",\n  \"typings\": \"index.d.ts\",\n  \"browser\": {\n    \"./register.js\": \"./register-shim.js\"\n  },\n  \"scripts\": {\n    \"test\": \"ava\"\n  },\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/kevinbeaty/any-promise\"\n  },\n  \"keywords\": [\n    \"promise\",\n    \"es6\"\n  ],\n  \"author\": \"Kevin Beaty\",\n  \"license\": \"MIT\",\n  \"bugs\": {\n    \"url\": \"https://github.com/kevinbeaty/any-promise/issues\"\n  },\n  \"homepage\": \"http://github.com/kevinbeaty/any-promise\",\n  \"dependencies\": {},\n  \"devDependencies\": {\n    \"ava\": \"^0.14.0\",\n    \"bluebird\": \"^3.0.0\",\n    \"es6-promise\": \"^3.0.0\",\n    \"is-promise\": \"^2.0.0\",\n    \"lie\": \"^3.0.0\",\n    \"mocha\": \"^2.0.0\",\n    \"native-promise-only\": \"^0.8.0\",\n    \"phantomjs-prebuilt\": \"^2.0.0\",\n    \"pinkie\": \"^2.0.0\",\n    \"promise\": \"^7.0.0\",\n    \"q\": \"^1.0.0\",\n    \"rsvp\": \"^3.0.0\",\n    \"vow\": \"^0.4.0\",\n    \"when\": \"^3.0.0\",\n    \"zuul\": \"^3.0.0\"\n  }\n}\n",
    "register-shim.js": "\"use strict\";\nmodule.exports = require('./loader')(window, loadImplementation)\n\n/**\n * Browser specific loadImplementation.  Always uses `window.Promise`\n *\n * To register a custom implementation, must register with `Promise` option.\n */\nfunction loadImplementation(){\n  if(typeof window.Promise === 'undefined'){\n    throw new Error(\"any-promise browser requires a polyfill or explicit registration\"+\n      \" e.g: require('any-promise/register/bluebird')\")\n  }\n  return {\n    Promise: window.Promise,\n    implementation: 'window.Promise'\n  }\n}\n",
    "loader.js": "\"use strict\"\n    // global key for user preferred registration\nvar REGISTRATION_KEY = '@@any-promise/REGISTRATION',\n    // Prior registration (preferred or detected)\n    registered = null\n\n/**\n * Registers the given implementation.  An implementation must\n * be registered prior to any call to `require(\"any-promise\")`,\n * typically on application load.\n *\n * If called with no arguments, will return registration in\n * following priority:\n *\n * For Node.js:\n *\n * 1. Previous registration\n * 2. global.Promise if node.js version >= 0.12\n * 3. Auto detected promise based on first sucessful require of\n *    known promise libraries. Note this is a last resort, as the\n *    loaded library is non-deterministic. node.js >= 0.12 will\n *    always use global.Promise over this priority list.\n * 4. Throws error.\n *\n * For Browser:\n *\n * 1. Previous registration\n * 2. window.Promise\n * 3. Throws error.\n *\n * Options:\n *\n * Promise: Desired Promise constructor\n * global: Boolean - Should the registration be cached in a global variable to\n * allow cross dependency/bundle registration?  (default true)\n */\nmodule.exports = function(root, loadImplementation){\n  return function register(implementation, opts){\n    implementation = implementation || null\n    opts = opts || {}\n    // global registration unless explicitly  {global: false} in options (default true)\n    var registerGlobal = opts.global !== false;\n\n    // load any previous global registration\n    if(registered === null && registerGlobal){\n      registered = root[REGISTRATION_KEY] || null\n    }\n\n    if(registered !== null\n        && implementation !== null\n        && registered.implementation !== implementation){\n      // Throw error if attempting to redefine implementation\n      throw new Error('any-promise already defined as \"'+registered.implementation+\n        '\".  You can only register an implementation before the first '+\n        ' call to require(\"any-promise\") and an implementation cannot be changed')\n    }\n\n    if(registered === null){\n      // use provided implementation\n      if(implementation !== null && typeof opts.Promise !== 'undefined'){\n        registered = {\n          Promise: opts.Promise,\n          implementation: implementation\n        }\n      } else {\n        // require implementation if implementation is specified but not provided\n        registered = loadImplementation(implementation)\n      }\n\n      if(registerGlobal){\n        // register preference globally in case multiple installations\n        root[REGISTRATION_KEY] = registered\n      }\n    }\n\n    return registered\n  }\n}\n"
  },
  "externals": []
}
